#ba1e

def get_patterns_forming_clumps(text, k_mere_size, clump_size, k_mere_limit)
	result = []
	while true
		result += get_most_frequent(text[0..clump_size], k_mere_size, k_mere_limit)
		text = text[1..-1]
		break if text.length < clump_size
	end
	return result.uniq.join(" ")
end

def get_most_frequent(text, k_mere_size, k_mere_limit)
	result = []
	frequencies = get_frequencies(text, k_mere_size)
	max_frequence = frequencies.values.max
	frequencies.each do |k_mere, k_mere_count|

		result << k_mere if k_mere_count >= k_mere_limit
	end
	return result
end

def get_frequencies(text, k_mere_size, word_scores = Hash.new { |h, k| h[k] = 0 })

	return word_scores if text.length < k_mere_size

	word_scores[text[0..(k_mere_size-1)]] += 1

	word_scores = get_frequencies(text[1..-1],k_mere_size,word_scores)

	return word_scores
end

puts get_patterns_forming_clumps("TCTGGACCCATTGAGGCCCGGAGGGCTAAGGAGCGAAACATGTCACGTCAGCGCGTCGAAACGACGGAGGCCATTTAGTTTATGGATAACGGGATGCTGTGGCACCCATGTAGAGGATATAACGGCCGGCCAAGAGTGTCGGCCTCTAATCGGGACTCTCCTATATCTAGTCTGTCTACATTTACATCCCGCAACAATCTGGAGTATAGGTGGCAATACCGCTGAGTGTGACTGATGCTTAACATCGCTATGAAACCGGTCGCATATAGCGTCATCCTCTCAGCTACGTAGAAGATTCTTGCGCTGTGGTGTACCGGGGGGAAAAAATCTCTCACGCCGACCGTAACAAAAGACGCTTCTCAAGTCTACGAAAATGAAGTCTCGCAGGGTGGATCTTCTCATTGACAGACGTACAAGTACGTTCGCTATTGTAAGCACAATCATACTAAATGGAGAGTGTGTGATGATGTCCCTTTTTGTGTATTAAGTCGCCAATCACGGACGCTTTTCCATAGAATTATTTTAATGTTTGTTGCAATAACCTCATTCGTAGCGGAACCGAGCGTCGCTTCGCATTCCGAAGAGCCAGCGCATTGGGCGCCTGCGCGGTGTCAGAGCGTCTTCGGTCTGATATGCGAAAAAGGAATTCTGCCTTTTGCCCGATGTACCACGTAGCAACAGTTCGCCTTATCATGCTTACGACGATCTACTAGGGCTCCTCCATATAGAGTGATTTCACGACTGCGCTAAGCAGGGATAGCCATGTCTGGGCATAGCGCGATAACACGAGGCAGTACGTCAAAGCTGCGAATGAGTTTCTCAAGTTCCCCCCAGCATCATAGTCCTGGTAACTTCCCATGCGCGGATGCGTAGCAAATTAGTGTTCCAGATTAATGAACAGCCCAGCCCTGGTATGCGGAAGTTTGCAGCTACCGAAGATCCCCGTCCACGCTCTACTACCCAGTATACCGACGGGCTGCCCTTCGAGGCCACTACTGATCTTTTGCTTCTCGCTAATCCTAGAGCGCTTCTGTACCCACCCCTGCTCGTACTGAGGGGCGTAGGAAATTCTAACGGGTAGAAACCGGCTAGAGGAGATAAGTCACAACAACTATGCTAGCATTGCTGTACGTGCACGACTTACTATGCGTCCCTGAGCATGCCGACCCTCAGGCCCAGCTTCTCGGCGCTTATCTTAATGGGCTGGGTGAGAGTCGTTTATAGAACCTGTCGGGCGCATGAGCTAATTGGCTCGGGCGCACATTCAAGCATACCTACTAAAGCACGACACTTACATTCGGCCGTGGTGTCTCCTCGTTGAAAACCTATCCCCAAGATACCCCGCCCGCTGTTAGCTCCGTTCTTTGCTGACTATCGGCAAGTAAGTCAACTAGAATGCATAGCCACTCACTATGCATACGTTAGATGGCAATGATTTGCCAACAGTGAAGTCGAGATACTGACTAGCCCGCCTTCAGCTCGGAGTTACCGAATCCTATAATGTATCTCTTCGGCAGGCGAAGTATCCTTATGGGAACAAGCGTTCGACACAACTTGATGCCGTCGCCCACAGTCACTAAGTACTGAAAGACAAGGTTCCAGTCGCGTCAAGAGTAGAGGTATTGGAGCGTGGGGATGCGAGACGAGCTTTAGGAGACTTCAAGGCTCAAAGGTGCCTCGACGTGTTATGTAGAACTTTAGAAAGGTAAAATACAGCACGAGTCATGCTATATAAATGTCATTGAACACCCAATTGATTTGGAACTGCCCGTACGTGACTCGTCAGTAAGTCGTTGGGAGAAGGTAAATTACATTGTGAGCCTGCGTCCGGGCCCAACTAACCGGAGGTTAGGCCAGGGCAAAGATTGGCCAGAAAATAAACGCATGGTTGCAGTCCCTAAAACCCCCATTGTTACTAGATGCGCTCTCAAGGTTATTGAGTCTGAGTCGGGGTTAGGTTATTGAGTCGGACTCCCGGTTATTGAGTCGTCGAGTTGAAAAGGTTATTGAGTCGGCGTAGGTTATTGAGTCCTCGCCATTCGATCGGTTATTGAGTCAATAGGCGGAGGTTATTGAGTCTCCTACCGTTCCCTACGGCAGGCGACACGTCAGTAGTGGTTATTGAGTCCCTGGGTGGTTATTGGTTATTGAGTCTATTGAGTCGTTATTGAGTCGGTGCAAACCGCTACACGCACCTGGTGGTTATTGAGTCGAGCGAGAGGTACATTAGGGTTATTGAGTCGGGGGTTATTGAGTCTTGAGTCAGGGGTTATTGAGTCGAACGTGTTACCAAGTCGTAATCAGAGGTTATTGAGTCGGTTCTAGGTTATTGAGTCTCACGTCGGACGTGGTTATTGAGTCATCGGTTATTGAGTCGGTTATTGAGTCCACAAGGGCGTGAATTGAGGTTATTGAGTCCCTCAGGTTATTGAGTCTCGGTAGGCTGGTTATTGAGTCTAGAAGGGTTATTGAGTCATGGGCTGGTTATTGAGTCGAGGGGGTATGCGCGACCTGATCAATTCGTTTAGTTAGATGCCATCTATGCGGAAGATACGTTCTTAAGCAGCATCCTAGCGAGATTCAATGCTATAGAGGGGACGGGTAGAAACCGTCGCCGCCCCGTAGTGGGTTAATAAGTTACGAGAACCCAAAATGCTATCCGGTAGGGGCTATCCCGACGACTGTCAGCTTTCCATTGGGCAGACCACCTGGAGTGAGACAGTGTACACTTGCCTGTTCCTTTGCCCATACCAAGTTTTAATTATTTCGTCATGCGCCCCATTTAGCGCGTTATCTTCGAACCATGTGATTGTGGAAGCTCGTGCGTACATGCCATCGAAGGCAACTTGACGACCGGTCCATATTGAGTCTTTTCAATGAAACGACATCTGAGGGGGCTTACATGTCGGCATCAGTGCTCCGGGAGCCGATTGCGATAAGCCTTTAAGGTCAGAGCCCGTAGGCTTTCCTGGAGACTGACTGGGACCCTGCTTCCTATTATGAGGGATACTGACTGTCAGTTGCGTTAGCGCCGCCTGCACGGTTGGTGTGATATGCCGGGTTAGCTGTACTCTGCATGAAGACACTTGTTCGTCAAGTAGGCGTATTGTCCCCACATGCTTATGCATCTTCCAGTCTTCTGATTTTCGTGGCTTGTATCGTGGTCGTCCTCTTACACATAGTTCTCCGTTTTGAAGAGGTTTTAGCTCTCGCGATGGCGCTCGCAATAGGATTGATGTACTCGAATGGAGACACCAGCATGCCTGTTTTTCCGAGTAGATCGTGATCAGCCGGGTACCGGGTAACCCCGCCCCGGCCGGGTAACCCCAAGCCCGCCGGGTAACCCCTGATTCCAATATAACCGGGTAACCCCGACCTACGTGAATTCCACGGCTGGCCGGGTAACCCCGGTAACCCCTCCCCGGGTAACCCCCGGGTAACCCCCCGGTGCGTATACGGCGCCCGGGTAACCCCAACCCCTGAAGACGGACAACCAACCGGCTTCCGGGTAACCCCGGGTTCGACCCTTCTTCCCGGGTAACCCCCACAAGGTGAGATACGGATAATCCGGGTAACCCCTGTTGAGGTCCTGCCGGGTAACCCCGTACTTTGTCCGGGTACCGGGTAACCCCCCGCCGGGTAACCCCGGATCACCAATAGCTGTGACCCGAACCTGACGAGTGTTTGGGTTGGGGAGTGTTTGGGCCGGGTAACCCCGGGCCGGGCCGGGTAACCCCACCCCAGTGTTTGGGTGTTTGGGGTGTTTGGGGTTTGGGTGTTTGGGCCGGGTAACCCCTCCGGGTAACCCCAACCCCTTTGGGTGCGACCGGGTAACCCCGTTTGGGATTTCCCGGGTACCGGGTAACCCCGTTCCGGGTAACCCCCCTTTGGGCCGCCGAGTGTTTGCGAGTGTTTGGGTTCCTCCGTCTTCCACCCGGCGGGAGAACGAGTGTTTGGGTGGGAAGCCGAGTGTTCGAGTGTTTGGGTTCGAGTGTTTGGGATCCGAGTGTTTGGGGACCTTGCCCGAGTCGAGTGTTTGGGACCGAGTGTTTGGGTGTGGCGAGTGTTTGGGGGGTCGAGTGTTTGGGGTGTTTGGGTGATTAGCAAAGAAGTCAGAGCAAGGCTGGCGTATGTCACGCGTGCCGCTCTAGGCCGAGTGTTTGGGGCAGCTTACCATCCATTACGGCAGGGCCTACCCTAAATTCTGGGTCCGACGATAAACCTTATTTCTGAAGTTAGTTCTACTGTTCATGCAAGTCGCCGGAACGACGATGGATAGTTCTACTGTTGAGTTCTACTGTTATACACCACCTGGTAATGGAGTAACTACCCTCTTACCGTTAATCATATACCAAGTTCTACTGAGTTCTACTAGTTCTACTGTTCTTTGGGGTTAGCAGTGTCACTTACTCTTAGTTCTACTGTTCCAATACAACTAGTATTCCGAGTTAGTTCTACTGTTTCTACTGAGTTCTACTGTTTAGTTCTACTGTTGGAGTTCTACTGTTAAGTTCTACTGTTACATAGTTCTAGTTCTACTGTTATCAGTTCTAGTTCTACTGTTTTTCTCGCTGTTCGGGTCTTGCACGGGAAGTTTCAAACGTCTCAAGCCGCTGTTACCCTCCCCCAAGTTCTACTGAGTTCTACTGTTGTTGGCTCATTAAAGTGGCTAAGTTCTACTGTAGTTCTAGTTCTACTGTTAGTTCAGTTCTACTGTTAGTTCTACTGTTTCTTGACACAACAAGATTTAAAGTTCTACTGTTGATCAAATAACGATTCAACGCCCGACACCTGGATTCATGCGGGGCACCGGAGTTCTACTGTTGTATTTTAAAAGCTCCTGGCGTACAGGCGGGCACGATAACAAGAACCCTACTCTGAAGACAATGAGCACTAACTCTCCACTTGATACTCAGAAGCACCGACGCTTCTGTAATGGCGCTGATTAACGCCATAGGGGTATACTCATGACCAGACTTAATGGGGTGGCCCGTCTCTCGGGGCACCGAACATAATTGGAATAGGAATGATTGTGATCATCCAGATTAGGGTATTCTGCGTAATTTACATTCAGTACCTTAGGGGCTCGTGCGGCATATTTCACGTGAGAGGGATCGAGCGTGAAAAAACAATAAGTCACCAGGTACGCTCCCTAAGCACGTAGAGTCCGATGTGTAGGAAGTTCCTTCAACCTGAGTGCTCAGGGGCCCCAGGGGGTTGTTTCGTAAGGATAAGATTTGTGAGCTGTTTTGATACACATTCAACCCCACGTTCCGGTTTCCATGAACCACGACCGAGTGAGTCACAAATGGTCCGCGGCTTCTTTTATCTTGGTCCAAGGAGTTTACTATCATTTACCGGTATCTGCTGCTGGTCAGTTCAGGCAGTGCTGGCTAGCATCGTATCCGGGCACTGGTTCTCGGACTAACCCAAAGACAGCCTAGGAAAGTTCGGCTACGGTAGTTGCTATTCCAACCGCCACCCTTTCCAGATCCCACCATTTGACCGAACGGGTGTTAGACAAGTTTGTTCTAGACCGGGAGGATCAGCCAAGAAACTTGATACCGTGAGGCCAACCAATAACGCCTCGGGACTTAACCCTTGAGCGATGCAGCTACCCGGCCGTGCATCTGTACAACGCTGCTAGAAGTGGTCGGATTACGCCGATTTTAACACCTAATTGGGTATGCTGGTGGCACACTAGATACATGCACAATTAGGAATCACCCCACGGCGTATCCCGAAAATCATTTGTTCTTATTCTCCCTGTCCGGCCTAAGTGGCCCCTTATAGTATGTGGATGTGCCGGGTAGGAAGTAAAGACGGCCGAATAGGCACTACAACGACTGCTGGTACGGTACAAGTTGGCCCGCTCGTCGTTAATTCGATGAGGTCTGATCTGATCAGCCCCGTCAACGTAAGTTCTCTCCCGGCCACTTCATACCCTTCCAAAGAGTAGACAAGTTAGAGATCGCGTACGGGCACGGGTTTGAACGTTATGCCATAACCGGTCCACGCTTTGGCTGCTAGTGAGATTGGTGTGAGTAAAGATGTTCACTTTAGCGCGTCCGTCTGAGTCTTATTGTAAGAGGACCATTTAATCTTAATGGCTAAGGCTTATGTCCTGAACCGGAAATATTATTTACCAATCATTCGGAAGCGTAGAAACCCGGGTATAATAAAGCTGAGTACAACAGAGGATAGAGGAAATGTAGGACACGCGCGTGGGTCCTAGAACGTGGCTACAAACAAGATAGTATCGTGCAAACGTATGACTACCAAACCTAGGGCTGAGTCTCACGACTTTGAACTGAGGCTGGGTTGTCGAACTAAATAGTACCGGCTTATACATGTCCACGGTGCTATAAGCAGGCCTTTGGCACCACTTTAGGCAGGCCGTACGATGAACGAAGCTACTTAGTGTCTCAGACTCGTCGGAAATTGGGCTCAATATCCGTCGGGAAGAAAAAAGGTGTATGATATATAGTAGACGTCGCGAGGCTATCGGAGTTGAGTTGGAGTCGTGCAAGGAAGTATGTCCGACAGTCCGCCACACTCATGTCATCCGCTTTTGCTATGCACCTATTAAGCCCGAGCTACACCTCATGACTAACTTAATCCACAGCATGGTCTCTGTAGACTGTCCTGCACCATAGGTAATCCAATATAGATTTTTATCCTCGAGTTGAGATTAAACACCCTCGGACGTCATCAGCCAAACTGTACGCTCATTGCTTCATGCTCCACAAAAATGGAGGAGCCAGTAGCCGCTGATGCACGTAAATGGAGGAGCGGAGCGGAGCAATGGAGGAAAATGGAGGAGCGCTGGTTATTAGCATCGGACTTAAGTTCGAGATGTATTATTGTGTAGGCGCCCACCAGTCGTTGCACTCCCGAAGTGCTGAAATGGAAATGGAGGAGCCCTCGAAATGGAGGAGCGGGCAAATGGAGGAGCGGAGAAATGGAGGAGCTGGAGGAGCGCCATCCAGAGATCTAAAATGGAGGAGCGCTGTAAATGGAAAATGGAGGAGCGCCCACAAAATGGAGGAGCCCTAGTTATCTCACAATTCGATACAAGGAAATGAAATGGAGGAGCTTCTCCCTACAGCCTACAGGCAAGATTCACGAGTTGATTCTCCCAAATGGAGGAGCCTCCTTCTAAATGGAGGAGAAATGGAGGAGCTCCCTACAAATGGAGGAGCGAGGAGCGAGGAAAATGGAGGAGCCAAGCAATTTCCATTCGAAATGGAGGAGCTACTAAATGAAATGGAGGAGCCTTTAAATGGAAATGGAGGAGCAGCGGAGGAGCCAATTACTGGCGTTACTGGCAACAACCCTACAGTCTTCCGTTACTGGCAAGCAAGTTATGAATATTCTCCCTACAGTGGATTTCTCCCTACTTCCGTTACTGGCGTTACTGGCAAATATATGCGACGTTACTGGCAAGCAACGTTACTGGCAATCGTTACTGGCAAAGGAGAGCCGGATTCGCGCTATGCCCGACCCACTTTTCTCCCTACAGTCGTTACTGGCAAAAATCGTTACTGGCAATCCCTACAGTGGTTTCTCCCTACCGTCGTTACTGGCAACACGTTACTGGCAAAACTCGTTACTGGCAACGTTACTGGCAAGGCAACGTTACTGGCAAGCCCCACGGTTATCATATTCTCCCTACAGCGGTTCTGTGCGCCTCCGCCCTTGATTTCGTTACTGGCAAATGCGGAGCCGTCGTCGTTACTGGCAATCTGGCCTCACGGGGAATGTTTCCCGCCCTGCGCACACTAACACGTTTGCGAGACTCTACAATCACACGGACATTCATGGAGCAATCTTCCAGCATCATAGTGTGTTGCGTTGCCCCGCTCCGTCATTCTGTGTGGTCGCGCGAAGGCGGCGACTTCATTCGCCGGTCATGCGGACGTTAAGGCCGTAGCACTATTGCCTTCACGTGAGAGAGGAGACGGCTGCCTAGAGGCTCTCAAGGTATAGTTTTAAATCATGCCGCTTCGTTGTCGGTTGACTAGTCATCACAGCACAAAATCTTACTCGGAGGATGGGGAATATCCACCCCTATCCACTTTTAGGGTCGTCGATTCTGAGATACTCACGTATTCTAGATACTAAAAACTAAAAGCACTAGAACTTATTTTAAGCAGCTGCAACAAGGAACGCGCATGCCAGAGGCCGATTAAGTGATCCCTGCATAGCATACGTCGTAGAGGAGCTAAGCCTCGTAATGTTAGTCCTGACGGCATCCATGTTACAACGTGCATCACTTGCTCATCCGGTCCCTTCACTGGAGAAAAGTTCAATATAGCACCAGTCGCAACGGATAAACTCGGCCTTAGGAAGCGCACGCTGCAATACCCCTTTAAATCCGGTCCGTGATCCCTCGTGTATCACAACCCTTCAGCGCACTATATATGGAGAGACTAAACATGCACATAGATCCTACGCCAGCGTCGAGATATCAACCCTATCACCAATTTTGAGGTAACGGATGAAAGGAGGCCGCCTGCTTAAATAGCACTGCGTGCACCCTAGCACTGTAGCACTGCGTGCACTGCGTGTCTGACTTAGCACTGCGTGGCACTGCGTGTGTAGCACTGCGTGGGAAGTCGTACACCGTAGCACTGCGTGGCGTGTGTAGCACTGCGTGCAGGAGTAGGCTAGATTGTGGTAGCACTGCGTGTGCGTGACGTTATAGCACTGCGTGGTGCACTGCTAGCACTGCGTGAGCACTGCGTAGCACTTAGCACTGCGTGTAATTGTAGCACTGCGTGTGGGATAATGCGAACTTGTGGTAGCACTGCGTGTGTCTTAGCACTGCGTGAGCACTGCGTGGTTGTGGATTGTGGATAATGGACTTGTGGATAATGTAGCACTGCGTGGTAGACTGAGGCGCATCTTGTAGCACTGCTAGCACTGCGTGCTACGTTGTTTTTAGCACTGCGTGAATGGTTTAAATTGTGGATAATGTGGGCGGTCCTAGCACTGCGTGCCCGGTAGTTGTGGATAATGCATGACAGGATAGCACTGCGTGTGACTAGCACTGCGTGCGTAGCACTGCGTGAATAGCACTGCGTGAGTCTAGTAGCGAGACGGCTAGCACTGCGTGTTAACTTGTGTTGTGGATAATGTACTATCAACGCGGAGCCCAAAGCGATTGTGGATAATTGTGGATAATGTGGATAATGAACATCTTGTGGATTGTGGATAATGCGTCCCTTGTGTTGTGGATAATGATAATGTTCCCTCTCATTTCCCTCTCACGTCGATCACGAGTATTTCCCTCTCAGTCCATTTCCCTCTCAGATTCCGGTATTTCCCTCTCAGGTAAATTTCCCTCTCATTCCCTCTCAGTGATCCACCAGGGATATTTCCCTCTCACTTCGTGGCGATTTCCATTTCCCTCTCAGTTAGATTCGTGCCTTGCTACAGTTTGCTCCTTGCCTTGCTACAGTTTATTTCCCTCTCACCTCTCCCTTGCTACAGTCTTGCTACAGTATGCCCTTGCTCCTTGCTACAGTGTCACCTTGCTACAGTTGCTACAGTTCAGCACGTTTGCGGGTATTTCCCTCTCATCGCATTTCCTTGCTACAGTCCTCTCACACCGACTCGGACCTTGCTACAGTGTTTTTCGCTGCCCTGGCCAATCCTTAGGTCGGACCAGTGGCGTCCTTGCTACAGTACAGTCTCACAGATTTCCCTCTCATCCCTCATTTCCCTCCCTCCTTGCTACCCTTGCTACAGTAGTCCTTGCTACCCTTGCTACAGTAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGTCCTTGCTACAGT",12,600,19)

